# Threading
CONFIG_MULTITHREADING=y
CONFIG_NUM_PREEMPT_PRIORITIES=16
CONFIG_MAIN_STACK_SIZE=3584

# GPIO & I2C
CONFIG_GPIO=y
CONFIG_I2C=y

# Sensors
CONFIG_SENSOR=y

# Display
CONFIG_DISPLAY=y
CONFIG_MICROBIT_DISPLAY=y

# Floating point support
CONFIG_CBPRINTF_FP_SUPPORT=y
CONFIG_FPU=y

# C library with math (picolibc is smaller than newlib)
CONFIG_PICOLIBC=y

# Input subsystem for buttons
CONFIG_INPUT=y

# Debug output / Console
CONFIG_PRINTK=y
CONFIG_CONSOLE=y
CONFIG_UART_CONSOLE=y

# Heap for message queue allocations (increased for BLE Central + Peripheral)
CONFIG_HEAP_MEM_POOL_SIZE=8192

# MCUboot Support (disabled for direct flash testing)
# CONFIG_BOOTLOADER_MCUBOOT=y
# CONFIG_MCUBOOT_GENERATE_UNSIGNED_IMAGE=y
# Flash support (disabled without MCUboot)
# CONFIG_FLASH=y
# CONFIG_FLASH_MAP=y
# CONFIG_FLASH_PAGE_LAYOUT=y
# CONFIG_STREAM_FLASH=y
# CONFIG_IMG_MANAGER=y

# MCUmgr core (disabled without MCUboot)
# CONFIG_NET_BUF=y
# CONFIG_ZCBOR=y
# CONFIG_CRC=y
# CONFIG_MCUMGR=y

# MCUmgr handlers (disabled without MCUboot)
# CONFIG_MCUMGR_GRP_IMG=y
# CONFIG_MCUMGR_GRP_OS=y

# Stack sizes (increased for BLE Central + Peripheral + OTA flash ops)
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=3072

# Size optimization
CONFIG_SIZE_OPTIMIZATIONS=y
CONFIG_SPEED_OPTIMIZATIONS=n

# Reduce code size
CONFIG_BOOT_BANNER=n

# =============================================================================
# Bluetooth Configuration (Central + Peripheral)
# =============================================================================
CONFIG_BT=y
CONFIG_BT_DEVICE_NAME="Ozzy"

# Peripheral role (for NUS output)
CONFIG_BT_PERIPHERAL=y

# Central role (for Xbox Controller)
CONFIG_BT_CENTRAL=y
CONFIG_BT_GATT_CLIENT=y

# Connection settings
CONFIG_BT_MAX_CONN=2
CONFIG_BT_MAX_PAIRED=2

# Security/Pairing/Bonding for Xbox Controller
CONFIG_BT_SMP=y
CONFIG_BT_BONDABLE=y
CONFIG_BT_SMP_APP_PAIRING_ACCEPT=y

# Persistent Bonding Storage
CONFIG_BT_SETTINGS=y
CONFIG_SETTINGS=y
CONFIG_NVS=y
CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_FLASH_PAGE_LAYOUT=y

# GATT settings for HID discovery
CONFIG_BT_GATT_AUTO_DISCOVER_CCC=y
CONFIG_BT_GATT_AUTO_UPDATE_MTU=y

# Larger MTU for text responses (PID params ~50 bytes)
CONFIG_BT_L2CAP_TX_MTU=247
CONFIG_BT_CTLR_DATA_LENGTH_MAX=251

# Buffer configuration for HID reports and dual connections
CONFIG_BT_L2CAP_TX_BUF_COUNT=6
CONFIG_BT_BUF_ACL_RX_SIZE=255
CONFIG_BT_BUF_ACL_TX_SIZE=255
CONFIG_BT_CTLR_RX_BUFFERS=4

# Scanning
CONFIG_BT_SCAN_WITH_IDENTITY=y

# Nordic UART Service (NUS) for BLE output
CONFIG_BT_ZEPHYR_NUS=y

# =============================================================================
# PWM for Motors and Speaker
# =============================================================================
CONFIG_PWM=y

# =============================================================================
# ADC for IR Sensors
# =============================================================================
CONFIG_ADC=y

# =============================================================================
# Thread Monitoring (minimal for reduced size)
# =============================================================================
CONFIG_THREAD_MONITOR=y
CONFIG_THREAD_NAME=y
# Disable stack/CPU stats to save ~10KB flash
# CONFIG_THREAD_STACK_INFO=y
# CONFIG_INIT_STACKS=y
# CONFIG_THREAD_RUNTIME_STATS=y
# CONFIG_SCHED_THREAD_USAGE=y

# =============================================================================
# OTA Dual-Slot System
# =============================================================================
# Use device tree code-partition for app start address (0x04000)
CONFIG_USE_DT_CODE_PARTITION=y

# CRC for OTA validation
CONFIG_CRC=y

# Reboot support for OTA commit
CONFIG_REBOOT=y
